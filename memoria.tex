\documentclass[a4paper, 12pt]{book}
\includeonly{introduction, chapter01, chapter02, chapter03-01, appendixA, appendixB}
\usepackage[a4paper, BCOR1cm]{typearea}
\usepackage[spanish, es-ucroman]{babel}
\usepackage[format=hang, font=small, labelfont=bf, labelsep=endash, width=.9\textwidth]{caption}
\usepackage[listofformat=subsimple, format=hang, labelfont=footnotesize, textfont={it, footnotesize}]{subfig}
\usepackage[color]{changebar}
\usepackage[latin1]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage[bf, sf]{titlesec}
\usepackage{titlesec}
\usepackage[nottoc]{tocbibind}
\usepackage[spanish]{varioref}
\usepackage{graphicx}
\usepackage{amsfonts, amsmath, amssymb, calc, color, fancyhdr, hyperref, ifthen, layouts, listings, nextpage, textcase}
\usepackage{array, booktabs, tabularx, tabulary, dcolumn, multirow, oldstyle, threeparttable}
\titleformat{\part}[display]{\centering\huge\sffamily\bfseries}{\partname\ \thepart}{.5\baselineskip}{}
\hypersetup{%
	pdftitle=Proceso de adquisición y tratamiento de señales de %
	ultrasonidos, pdfauthor=José Ramón Gisbert Valls, pdfcreator=Vim 7.2,%
	pdfstartview=FitH, colorlinks=true, pdfdisplaydoctitle=true,%
	naturalnames=true, breaklinks=true, linkcolor=black,%
	bookmarksopen=true, bookmarksopenlevel=1
}
\fancypagestyle{plain}{%
	\fancyhf{}
	\renewcommand\headrulewidth{0pt}
}
\lstloadlanguages{Matlab}
\lstset{language=Matlab, extendedchars=true, breaklines, captionpos=b, %
	morekeywords={addchannel, analoginput, catch, datadqcallback, daqfind, daqhwinfo, errordlg, gcbo, getdata, %
	guidata, localDaqCallback, peekdata, single_channel, start, stop, strcmpi, trigger, try, warning} %
	}
\lstdefinestyle{displayed}{float=htbp, frame=l, tabsize=5, framerule=1.2pt, abovecaptionskip=\medskipamount, %
	rulecolor={\color[gray]{0.8}}, gobble=4, linewidth=.975\textwidth, xleftmargin=.05\textwidth}
\cbcolor{red}
\labelformat{equation}{ecuación~#1}
\labelformat{figure}{figura~#1}
\labelformat{section}{sección~#1}
\labelformat{subsection}{sección~#1}
\labelformat{subsubsection}{sección~#1}
\labelformat{table}{cuadro~#1}
\labelformat{footnote}{#1\protect\iscurrentchapter{\thechapter}}
\setkeys{Gin}{width=.8\textwidth}
\graphicspath{{./pictures/}{../pictures/}}
\DeclareCaptionLabelFormat{cont}{#1~#2\alph{ContinuedFloat}}
\captionsetup[ContinuedFloat]{labelformat=cont}
\newcommand\matlab{\textsc{matlab}}
\newcommand\kpci{\textsc{kpci}-3108}
\newcommand\datx{\emph{Data Acquisition Toolbox}}
\newcommand\iscurrentchapter[1]{\ifthenelse{\equal{#1}{\thechapter}}{  en el Capítulo~#1}}
\newcommand\miniit[1]{\begin{itemize} #1 \end{itemize}}
\newcommand\tnotetext[2]{\item\hspace*{-5pt}\raisebox{.7ex}{\fontsize{7pt}{8.4pt}\selectfont\normalfont #1}{\footnotesize #2}}
\newenvironment{TableNotes}{\begin{tablenotes}\vspace{\footnotesep}\footnoterule\vspace{.2ex}}{\end{tablenotes}}
\renewcommand\cleardoublepage{\cleartooddpage[\thispagestyle{empty}]}
\newcolumntype{d}[1]{D{,}{,}{#1}}
\newcolumntype{+}{D{/}{\mbox{\ --\ }}{5}}
\begin{document}

\fancyhf{}
\cfoot{\sffamily\bfseries\thepage}
\renewcommand\headrulewidth{0pt}
\pagestyle{fancy}

\frontmatter

\tableofcontents

\listoftables

\listoffigures

\include{introduction}

\fancyhf{}
\fancyhead[RO, LE]{\sffamily\bfseries\thepage}
\fancyhead[LO]{\sffamily\nouppercase{\rightmark}}
\fancyhead[RE]{\sffamily\nouppercase{\leftmark}}
\renewcommand\headrulewidth{0.4pt}
\pagestyle{fancy}
\renewcommand\chaptermark[1]{\markboth{#1}{}}

\mainmatter

\part{Sistema de adquisición y procesado de señales}

\include{chapter01}

\include{chapter02}

\part{Ensayos no destructivos con ultrasonidos}

\include{chapter03-01}

\part*{Apéndices}

\setcounter{page}{1}
\renewcommand\thepage{\thechapter.\arabic{page}}
\appendix

\include{appendixA}

\setcounter{page}{1}
\include{appendixB}

\backmatter

\end{document}
