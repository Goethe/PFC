%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%		 Proyecto Fin de Carrera		   %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper, 12pt]				{book}

%%%%%%%%%%%%%%%%%%%%%%%%%        Preámbulo        %%%%%%%%%%%%%%%%%%%%%%%%%

\includeonly{gis-pfc-pro,  gis-pfc-part1, gis-pfc-part2, gis-pfc-ch1,
	     gis-pfc-ch2,  gis-pfc-ch3,   gis-pfc-ch4,   gis-pfc-ch5,
	     gis-pfc-ch6,  gis-pfc-appa}

\usepackage[english, spanish]				{babel}
\usepackage[utf8]					{inputenc}
\usepackage[T1]						{fontenc}
\usepackage[altbullet, nofontinfo]			{lucidabr}

\usepackage[clearempty]					{titlesec}
\usepackage[nottoc]					{tocbibind}
\usepackage[spanish]					{varioref}
\usepackage[noauto]					{chappg}
\usepackage						{graphicx}

\usepackage{amsfonts, amsmath,  amssymb,  calc,     color,    fancyhdr}
\usepackage{hyperref, ifthen,   layouts,  tabulary, rotating, textcase}
\usepackage{array,    booktabs, tabularx, listings, dcolumn,  multirow}
\usepackage{afterpage}

\usepackage[format    = hang,
	    font      = small,
	    labelfont = bf,
	    labelsep  = endash,
	    width     = .9\textwidth]			{caption}

\usepackage[listofformat=subsimple, format=hang, captionskip=10pt,
labelfont=footnotesize, textfont={it, footnotesize}]	{subfig}

\usepackage						{threeparttable}
\usepackage						{textcomp}
\usepackage[spanish]					{cleveref}

\setcounter{lofdepth}{2}				% subfig

\titleformat{\part}[display]				% titlesec
	{\centering\huge\bfseries}
	{\partname\ \thepart}
	{.5\baselineskip}{}

%--------------------------------hyperref---------------------------------%
\hypersetup{
	pdftitle           = Ensayos no destructivos mediante ultrasonidos
	                     en madera de palmera (Adquisición y
			     tratamiento digital de señales ultrasónicas),
	pdfauthor          = José Ramón Gisbert Valls,
	pdfcreator         = Vim 7.2-3,
	pdfstartview       = FitH,		colorlinks    = true,
	pdfdisplaydoctitle = true, 		linkcolor     = black,
	citecolor          = black,		bookmarksopen = true,
	bookmarksopenlevel = 0,			urlcolor      = black
}
%-------------------------------\hyperref---------------------------------%

%--------------------------------fancyhdr---------------------------------%
\fancypagestyle{plain}{
	\fancyhf{}
	\renewcommand\headrulewidth{0pt}
}
\fancypagestyle{Number}{
	\fancyhf{}
	\fancyfoot[C]{\bfseries\scshape\thepage}
	\renewcommand\headrulewidth{0pt}
}
\fancypagestyle{number}{
	\fancyhf{}
	\fancyfoot[C]{\footnotesize\sffamily\bfseries\thepage}
	\renewcommand\headrulewidth{0pt}
}
\fancypagestyle{body}{
	\fancyhf{}
	\fancyhead[RO, LE]{\footnotesize\sffamily\bfseries\thepage}
	\fancyhead[LO]{\footnotesize\sffamily\nouppercase{\rightmark}}
	\fancyhead[RE]{\footnotesize\sffamily\nouppercase{\leftmark}}
	\fancyhfoffset[RO, LE]{(\marginparwidth + \marginparsep)/2}
	\renewcommand\headrulewidth{0pt}
	\renewcommand\chaptermark[1]{\markboth{##1}{}}
}
\setlength\marginparsep{12pt}
\setlength\marginparwidth{\pdfpagewidth - \textwidth - \oddsidemargin -
	2\marginparsep - 1in}
%-------------------------------\fancyhdr---------------------------------%

%--------------------------------listings---------------------------------%
\lstloadlanguages{Matlab}

\lstset{language      = Matlab,
	basicstyle    = \ttfamily,
	keywordstyle  = \sffamily\bfseries,
	extendedchars = true,
	breaklines,
	captionpos    = b,
	morekeywords  = {addchannel,     analoginput, catch,
	datadqcallback,	 daqfind,        daqhwinfo,   errordlg,
	gcbo,            getdata,        guidata,     localDaqCallback,
	peekdata,        single_channel, start,       stop,
	strcmpi,	 trigger,        try,         warning}
}

\lstdefinestyle{displayed}{
	float            = tpbh,           tabsize     = 5,
	abovecaptionskip = \bigskipamount, gobble      = 4,
	xleftmargin      = .082\textwidth, numbers     = left,
	numberstyle      = \tiny,          numbersep   = 5pt
}
%-------------------------------\listings---------------------------------%

\crefname{lstlisting}	{fragmento de código}{fragmentos de código}
\crefname{listing}	{fragmento de código}{fragmentos de código}
\crefname{subsection}	{subapartado}        {subapartados}
\crefname{subsubsection}{subapartado}        {subapartados}	% cleveref

\graphicspath{{./pictures/}{../pictures/}}			% graphics

\DeclareCaptionLabelFormat{cont}{#1~#2\alph{ContinuedFloat}}	% caption
\captionsetup[ContinuedFloat]{labelformat=cont}
\DeclareCaptionLabelFormat{romanos}{\textbf{(\,\Roman{figure}\,)}}
\DeclareCaptionListFormat{romanos}{\thepart\,.\,\Roman{figure}\,}

\newcommand\tnotetext[2]				   % threeparttable
	{\item\hspace*{-5pt}\raisebox{.7ex}
	{\fontsize{7pt}{8.4pt}\selectfont\normalfont #1}
	{\hspace*{-0.2em}\footnotesize #2}}
\newenvironment{TableNotes}{\begin{tablenotes}
	\vspace{\footnotesep}
	\footnoterule\vspace{.2ex}}
	{\end{tablenotes}}

\renewcommand\chappgsep{}					%% chappg

\newcolumntype{d}[1]{D{,}{,}{#1}}			  % dcolumn + array
\newcolumntype{+}{D{/}{\mbox{\ --\ }}{5}}

% Convenios tipográficos: siglas (primera vez), siglas, funciones,
% argumentos, propiedades, atributos de propiedades, nombres de canal o
% puerto
\newcommand\psig[1]{\emph{\MakeTextUppercase{#1}}}
\newcommand\sig [1]{\textsc{\MakeTextLowercase{#1}}}
\newcommand\func[1]{\texttt{#1}}
\newcommand\argu[1]{\texttt{#1}}
\newcommand\prop[1]{\textsf{#1}}
\newcommand\atr [1]{\textsf{#1}}
\newcommand\can [1]{\sig{#1}}

% Palabras predefinidas
\newcommand\matlab{\sig{MATLAB}}
\newcommand\kpci  {\sig{KPCI}-3108}
\newcommand\datx  {\sig{DAT}}
\newcommand\gui   {\sig{GUI}}
\newcommand\guide {\sig{GUIDE}}
\newcommand\pc    {\sig{pc}}
\newcommand\ram   {\sig{ram}}
\newcommand\AOUA  {\ensuremath{\mu}\sig{a}741}
\newcommand\kms   {kmus/s}

\newcommand\miniit[1]{\begin{itemize} #1 \end{itemize}}		% miniit

\newcommand\prosec{						% prosec
	\smallskip\begin{center}
		\usefont{T1}{hlh}{m}{n}
		\UseTextSymbol{OMS}{\textasteriskcentered}\quad
		\UseTextSymbol{OMS}{\textasteriskcentered}\quad
		\UseTextSymbol{OMS}{\textasteriskcentered}
	\end{center}\smallskip}

\newcommand\longpage [1][1]{\enlargethispage {#1\baselineskip}}	% longpage
\newcommand\llongpage[1][0]{\enlargethispage*{#1\baselineskip}}
\newcommand\shortpage[1][1]{\enlargethispage{-#1\baselineskip}}
\newcommand\sshortpage[1][1]{\enlargethispage*{-#1\baselineskip}}

\renewcommand\labelitemi{\textbullet}				% itemize
\renewcommand\labelitemii{\leavevmode\hbox to 1.1ex
	{\hss\vrule height .7ex width .5ex depth -.15ex\hss}}

\makeatletter
    \renewcommand\@pnumwidth{20.4pt}				% pnumwidth
    \renewcommand\l@figure  {\@dottedtocline{1}{1.5em}{2.8em}}
\makeatother
\newcommand\eletras{
	\renewcommand\labelenumi{\textsc{\alph{enumi}}.}}	% enumerate
\newcommand\itembf[1]{\item\textbf{#1} ---}
\newcommand\sectionlabel{
	\renewcommand\thesection{\arabic{section}}}		% sectionl
\newcounter{totalpages}					       % totalpages

%%%%%%%%%%%%%%%%%%%%%%%%         Contenido         %%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\pagestyle{Number}						% fancyhdr


\frontmatter

\tableofcontents
\listoftables
\listoffigures
\include{gis-pfc-pro}


\mainmatter

\part[Implementación del sistema digital de medida] %
{Diseño e implementación del sistema digital de medida}
\pagestyle{number}						% fancyhdr
\include{gis-pfc-part1}
\pagestyle{body}						% fancyhdr
\include{gis-pfc-ch1}
\include{gis-pfc-ch2}
\include{gis-pfc-ch3}
\include{gis-pfc-ch4}
\part[\textsc{endus} en madera de palmera] %
{Ensayos no destructivos en madera de palmera}
\pagestyle{number}						% fancyhdr
\include{gis-pfc-part2}
\pagestyle{body}						% fancyhdr
\include{gis-pfc-ch5}
\include{gis-pfc-ch6}

\part*{Apéndices}

\appendix
\addtocounter{totalpages}{\value{page} + 1}		       % totalpages
\pagenumbering{bychapter}					% chappg
\include{gis-pfc-appa}


\backmatter

\addtocounter{totalpages}{\value{page} - 1}		       % totalpages
\pagenumbering{arabic}
\setcounter{page}{\value{totalpages}}			       % totalpages
\nocite{
    mittelbach2004lc,   stutzman1997atd,    garcia2000mrsr,   pallas2004sas,
    bucur2006aw,        bucur2003ndciw,     proakis1998tds,   sedra1999cm,
    ramos2000dpdr,      ruiz2006pcmuit,     ruiz2002nlamns,   ruiz2002pst,
    mathworks2010mcgui, mathworks2009datug, keithley2001kpci}
\bibliographystyle{gis-pfc}
\bibliography{gis-pfc}

\end{document}
