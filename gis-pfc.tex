\documentclass[a4paper, 12pt]{book}
\includeonly{gis-pfc-pro, gis-pfc-ch1, gis-pfc-ch2, gis-pfc-ch3, %
	gis-pfc-ch4, gis-pfc-ch5, gis-pfc-appa, gis-pfc-appb}
\usepackage[english, spanish]{babel}
\usepackage[format=hang, font=small, labelfont=bf, labelsep=endash, width=.9\textwidth]{caption}
\usepackage[listofformat=subsimple, format=hang, labelfont=footnotesize, %
	textfont={it, footnotesize}]{subfig}
\usepackage[latin1]{inputenc}
\usepackage[nofontinfo]{lucidabr}
\usepackage[T1]{fontenc}
\usepackage[clearempty]{titlesec}
\usepackage[nottoc]{tocbibind}
\usepackage[spanish]{varioref}
\usepackage{graphicx}
\usepackage{amsfonts, amsmath, amssymb, calc, color, fancyhdr, hyperref, ifthen, layouts, %
	listings, textcase}
\usepackage{array, booktabs, tabularx, tabulary, dcolumn, multirow, threeparttable}
\usepackage[fixlanguage, noisbn]{babelbib}
\usepackage[spanish]{cleveref}
\titleformat{\part}[display]{\centering\huge\bfseries}{\partname\ \thepart}%
	{.5\baselineskip}{}
\titleformat{name=\subsubsection,page=even}[leftmargin]{\small\scshape\filleft}{\thesubsubsection}{\margiparsep}{}
\titleformat{name=\subsubsection,page=odd}[rightmargin]{\small\scshape\filright}{\thesubsubsection}{\margiparsep}{}
\titlespacing{\subsubsection}{\marginparwidth}{3.5ex plus 1ex minus .2ex}{\marginparsep}
\titlespacing*{\subparagraph}{\parindent}{3.5ex plus 1ex minus .2ex}{1em}
\hypersetup{%
	pdftitle=Proceso de adquisición y tratamiento de señales de %
	ultrasonidos, pdfauthor=José Ramón Gisbert Valls, pdfcreator=Vim 7.2,%
	pdfstartview=FitH, colorlinks=true, pdfdisplaydoctitle=true,%
	linkcolor=black, citecolor=black, bookmarksopen=true, bookmarksopenlevel=0, %
	urlcolor=black
}
\fancypagestyle{plain}{%
	\fancyhf{}
	\renewcommand\headrulewidth{0pt}
}
\lstloadlanguages{Matlab}
\lstset{language=Matlab, extendedchars=true, breaklines, captionpos=b, %
	morekeywords={addchannel, analoginput, catch, datadqcallback, %
	daqfind, daqhwinfo, errordlg, gcbo, getdata, guidata, localDaqCallback, %
	peekdata, single_channel, start, stop, strcmpi, trigger, try, warning} %
	}
\lstdefinestyle{displayed}{float=tpbh, frame=l, tabsize=5, framerule=1.2pt, %
	abovecaptionskip=\medskipamount, gobble=4, %
	linewidth=.975\textwidth, xleftmargin=.05\textwidth}
\crefname{lstlisting}{fragmento de código}{fragmentos de código}
\crefname{listing}{fragmento de código}{fragmentos de código}
\crefname{subsection}{subapartado}{subapartados}
\crefname{subsubsection}{subapartado}{subapartados}
\graphicspath{{./pictures/}{../pictures/}}
\DeclareCaptionLabelFormat{cont}{#1~#2\alph{ContinuedFloat}}
\captionsetup[ContinuedFloat]{labelformat=cont}
\selectbiblanguage{spanish}
\setbtxfallbacklanguage{english}
\setlength\marginparsep{12pt}
\setlength\marginparwidth{\pdfpagewidth - \textwidth - \oddsidemargin - %
	2\marginparsep - 1in}
% Se aplica el siguiente convenio tipográfico a la primera aparición de una sigla.
\newcommand\psig[1]{\emph{\MakeTextUppercase{#1}}}
% Se aplica el siguiente convenio tipográfico a siglas.
\newcommand\sig[1]{\textsc{\MakeTextLowercase{#1}}}
% Se aplica el siguiente convenio tipográfico a funciones.
\newcommand\func[1]{\texttt{#1}}
% Se aplica el siguiente convenio a argumentos de función distintos de propiedades.
\newcommand\argu[1]{\texttt{#1}}
% Se aplica el siguiente convenio tipográfico a propiedades.
\newcommand\prop[1]{\textsf{#1}}
% Se aplica el siguiente convenio a atributos de propiedades.
\newcommand\atr[1]{\textsf{#1}}
% Se aplica el siguiente convenio tipográfico a nombres de canal o puerto.
\newcommand\can[1]{\sig{#1}}
\newcommand\matlab{\sig{MATLAB}}
\newcommand\kpci{\sig{KPCI}-3108}
\newcommand\datx{\sig{DAT}}
\newcommand\gui{\sig{GUI}}
\newcommand\guide{\sig{GUIDE}}
\newcommand\pc{\sig{pc}}
\newcommand\ram{\sig{ram}}
\newcommand\AOUA{$\mu$\sig{a}741}
\newcommand\miniit[1]{\begin{itemize} #1 \end{itemize}}
\newcommand\tnotetext[2]{\item\hspace*{-5pt}\raisebox{.7ex}%
	{\fontsize{7pt}{8.4pt}\selectfont\normalfont #1}{\footnotesize #2}}
\newenvironment{TableNotes}{\begin{tablenotes}\vspace{\footnotesep}%
	\footnoterule\vspace{.2ex}}{\end{tablenotes}}
\newcolumntype{d}[1]{D{,}{,}{#1}}
\newcolumntype{+}{D{/}{\mbox{\ --\ }}{5}}
\begin{document}

\setuplayouts
\fancyhf{}
\cfoot{\bfseries\scshape\thepage}
\renewcommand\headrulewidth{0pt}
\pagestyle{fancy}

\frontmatter

\tableofcontents

\listoftables

\listoffigures

\include{gis-pfc-pro}

\fancyhf{}
\fancyhead[RO, LE]{\footnotesize\sffamily\bfseries\thepage}
\fancyhead[LO]{\footnotesize\sffamily\nouppercase{\rightmark}}
\fancyhead[RE]{\footnotesize\sffamily\nouppercase{\leftmark}}
\renewcommand\headrulewidth{0.4pt}
\renewcommand\chaptermark[1]{\markboth{#1}{}}
\pagestyle{fancy}

\mainmatter

\part[Implementación del sistema digital de medida]{Diseño e implementación del sistema digital de medida}

\include{gis-pfc-ch1}

\include{gis-pfc-ch2}

\include{gis-pfc-ch3}

\include{gis-pfc-ch4}

\part[\textsc{endus} en madera de palmera]{Ensayos no destructivos en madera de palmera}

\include{gis-pfc-ch5}

\part*{Apéndices}

\newcounter{totalpages}
\setcounter{totalpages}{\value{page}}
\setcounter{page}{1}
\renewcommand\thepage{\thechapter.\arabic{page}}
\appendix

\include{gis-pfc-appa}

\addtocounter{totalpages}{\value{page}}
\addtocounter{totalpages}{-1}
\setcounter{page}{1}

\include{gis-pfc-appb}

\backmatter

\addtocounter{totalpages}{\value{page}}
\addtocounter{totalpages}{-1}
\setcounter{page}{\value{totalpages}}
\renewcommand\thepage{\arabic{page}}
\nocite{mittelbach2004lc, stutzman1997atd, garcia2000mrsr, pallas2004sas}
\bibliographystyle{bababbrv-lf}
\bibliography{gis-pfc}

\end{document}
