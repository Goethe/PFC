\chapter{Aplicación para el control de la tarjeta}

\section{Introducción}

Desde los inicios de este proyecto lo que se ha pretendido es emplear un sistema de adquisición de señales como un osciloscopio digital. Para ello son necesarios la tarjeta de adquisición y un software que permita al usuario controlar el dispositivo desde una interfaz intuitiva y visualizar los resultados de forma sencilla.


\subsection{Elección del entorno de desarrollo}

El lenguaje o, mejor dicho, plataforma que se ha empleado para el desarrollo de dicho software es \matlab{}, la razón, su inmejorable compatibilidad con el hardware disponible. A partir de ahí, los componentes de \matlab{} que se han empleado para conseguir que el software de control gozase de las características previstas por los objetivos del proyecto son dos: el entorno de desarrollo de interfaces gráficas de usuario (\textsc{gui}) de \matlab{}, más conocido como \textsc{guide} (\emph{graphical user interface development environment}); y el \emph{Data Acquisition Toolbox} de \matlab{}. El primero de ellos se ha empleado para, como su nombre indica, crear la interfaz que comunica el dispositivo con el usuario. Esta comunicación se hace a través del segundo de los componentes mencionados, éste permite, mediante comandos de \matlab{} que pueden incluirse en rutinas o llamarse por separado, manejar el dispositivo ---convocarlo a muestrear, configurar sus propiedades--- y administra automáticamente los resultados almacenándolos en búffers situados en la memoria volátil del ordenador, haciéndolos de este modo accesibles al administrador de la tarjeta.\par % por un espacio de tiempo limitado


\subsection{Funcionamiento de un osciloscopio}

Como se ha mencionado, el modelo de funcionamiento utilizado como referencia en el desarrollo de la aplicación de control es el de un osciloscopio. Por ello, y en base a las conclusiones extraídas durante la realización de este proyecto, se ha creído conveniente explicar sin profundizar como funciona de manera habitual un osciloscopio digital. % remarcar un aspecto del funcionamiento habitual de cualquier osciloscopio.\par
En la actualidad suelen emplearse osciloscopios digitales. Éstos a diferencia de sus análogos analógicos no realizan una representación de la señal en tiempo real. Los osciloscopios analógicos emplean un tubo de rayos catódicos y un monitor de fósforo para generar una imagen de la señal. La posición vertical del cursor que el tubo crea en el monitor refleja a cada momento el valor de tensión de la señal eléctrica que entra al osciloscopio. El monitor preserva una traza del cursor que va barriendo periódicamente la pantalla de izquierda a derecha y así se forma la imagen que representa a la señal.
El procedimiento es completamente diferente en los osciloscopios digitales. No existe ningún cursor, se generan imágenes completas, una vez aparece una imagen por pantalla permanece estática hasta que una nueva imagen la sustituye. El proceso es tan rápido que se crea una sensación de movimiento.

En su lugar, digitalizan las señales analógicas a su entrada y almacenan las señales digitales resultantes en una memoria intermedia. Antes de representar una señal digital, esta se somete a un procesado digital el cual permite la implementación de nuevas funciones en el osciloscopio.\par
La función de \emph{trigger} o disparo, por ejemplo, consiste en centrar la representación de la señal en la ventana del osciloscopio de forma que las transiciones de la propia señal u otra señal auxiliar a través de un determinado valor de umbral queden alineadas con los ejes verticales de la ventana. La implementación de esta función requiere que antes del procesado haya almacenado en memoria un fragmento de la señal digitalizada cuya duración sea, no sólo suficiente como para cubrir la ventana del osciloscopio, si no también para realizar el oportuno desplazamiento. Las razones son obvias, en primer lugar interesa detectar antes de representar posibles cortes con el nivel de umbral en el marco


% En su lugar se representa de forma secuencial, a cuadros, como en la televisión o el cine. Periódicamente se digitaliza un fragmento de la señal, se procesa y se saca por pantalla. La señal llega al osciloscopio de forma continua, transcurre un periodo de tiempo durante el cual la señal se va digitalizando y almacenando en memoria, se detiene la digitalización se inicia el procesado de la señal digital, una vez la señal se ha procesado se representa la señal resultante en el monitor del osciloscopio. Y así periódicamente. Funciones como la de disparo requieren que se digitalice un fragmento de señal de duración mayor a lo que puede representarse, lo que no cabe se descarta a efectos prácticos (en realidad sigue en memoria pero no se representa, así es como funciona el offset temporal, si se va hacia instantes posteriores de la señal se empieza a registrar la señal digitalizada en memoria y se representa según se gire el control de offset). La función de disparo introduce un retardo innecesario. Antes era necesario un retardo igual al eje de tiempos ahora aún más.
% El periodo de refresco está muy relacionado con el eje de tiempos.
% La representación como proceso secuencial (en contraposición a continuo, pero continuo a pasos, de ventana a ventana) y periódico (siempre con la misma frecuencia, cada cuadro aparece después de transcurrir el mismo periodo de tiempo desde el cuadro anterior).

La mayoría de funciones que se añaden al osciloscopio digital también requieren un pedazo de señal digitalizada en memoria antes del procesado, aunque tal vez sólo de duración igual al eje de tiempos, en cualquier caso el procesado induce un retardo en el proceso de representación, desde que la señal llega al osciloscopio hasta que finalmente se representa. La magnitud del retardo es independiente de la potencia del osciloscopio, incluyendo frecuencia de muestreo y velocidad de procesado, y depende exclusivamente del eje de tiempos de la ventana. Surge, como va a mostrarse a continuación, un inconveniente.

% Para poder implementar una característica como la que se ha descrito es necesario, antes de la representación, que se haya digitalizado ya y almacenado en memoria un fragmento de la señal cuya duración no sólo suficiente como para cubrir el eje de tiempos de la ventana, si no también para permitir desplazar la información sin que aparezcan huecos.
% Sistema digital, procesado digital, requiere que todas las muestras que vayan a representarse estén antes en memoria para que puedan procesarse.
% Además como el objeto de este procesado es entre otras cosas centrar las transiciones que la señal realiza sobre un determinado umbral en los ejes de la ventana, es necesario desplazar la señal en el eje de tiempos y, por tanto, se necesita en memoria un trozo de señal más largo.
% Eje de tiempos ajustable más tasa de refresco suficiente para engañar al ojo humano igual a que el eje de tiempos es tan grande a veces que no se puede engañar al ojo humano independientemente de la potencia del osciloscopio
